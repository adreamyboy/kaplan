Ext.namespace('K.kreports.kqueryanalizer');K.kreports.kqueryanalizer.describeStore=new Ext.data.Store({fields:['id','select_type','table','type','possible_keys','key','key_len','ref','rows','Extra'],proxy:{type:'memory',reader:{type:'json'}}});K.kreports.kqueryanalizer.describeColumns=[{text:'id',dataIndex:'id'},{text:'select_type',dataIndex:'select_type'},{text:'table',dataIndex:'table'},{text:'type',dataIndex:'type'},{text:'possible_keys',dataIndex:'possible_keys'},{text:'key',dataIndex:'key'},{text:'key_len',dataIndex:'key_len'},{text:'ref',dataIndex:'ref'},{text:'rows',dataIndex:'rows'},{text:'Extra',dataIndex:'Extra'}];K.kreports.kqueryanalizer.window=new Ext.window.Window({title:'Query Analizer',height:400,width:600,layout:'fit',closeAction:'hide',items:[{xtype:'tabpanel',layout:'fit',items:[{title:'main',layout:'vbox',items:[{xtype:'textarea',flex:1,width:'100%',id:'kqueryanalazyerquerymain'},{xtype:'gridpanel',width:'100%',flex:1,columns:K.kreports.kqueryanalizer.describeColumns,store:K.kreports.kqueryanalizer.describeStore,id:'kqueryanalazyerquerymgrid'}]},{title:'count',layout:'fit',items:[{xtype:'textarea',id:'kqueryanalazyerquerycount'}]}]}],listeners:{show:function(){Ext.Ajax.request({url:'index.php?module=KReports&to_pdf=true&action=pluginaction&plugin=kqueryanalizer&pluginaction=get_sql&whereConditions='+K.kreports.DetailView.ae(),success:function(response){var queryObject=Ext.JSON.decode(response.responseText);Ext.getCmp('kqueryanalazyerquerymain').setValue(queryObject.main);Ext.getCmp('kqueryanalazyerquerycount').setValue(queryObject.count);for(var i=0;i<queryObject.descResult.length;i++){eval("var resultObjectByIndex = "+K.kreports.decode64(queryObject.descResult[i]));K.kreports.kqueryanalizer.describeStore.add(resultObjectByIndex);}},failure:function(){},timeout:120000,params:{record:document.getElementById('recordid').value}});}}})