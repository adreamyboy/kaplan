Ext.namespace('K.kreports.standardwpreviewview');Ext.define('K.kreports.standardwpreviewview.aD',{extend:'Ext.data.Model',fields:FieldsArray});K.kreports.standardwpreviewview.store=new Ext.data.Store({model:K.kreports.standardwpreviewview.aD,reCount:false,whereConditions:null,proxy:new Ext.data.HttpProxy({actionMethods:{create:"POST",read:"POST",update:"POST",destroy:"POST"},url:'index.php?module=KReports&action=load_report&to_pdf=true',method:'POST',extraParams:{requester:document.getElementById('recordid').value}}),reader:new Ext.data.reader.Json({root:'records',totalProperty:'count'}),remoteSort:true,listeners:{load:function(){if(K.kreports.standardwpreviewview.store.reCount==true){bm();K.kreports.standardwpreviewview.store.reCount=false;}}}});var aS='Synchronous';var ba=25;if(document.getElementById('listtypeproperties').value!=''){listTypeProperties=Ext.JSON.decode(document.getElementById('listtypeproperties').value);if(listTypeProperties.standardViewProperties!=undefined&&listTypeProperties.standardViewProperties.processCount!=undefined&&listTypeProperties.standardViewProperties.processCount!='')aS=listTypeProperties.standardViewProperties.processCount;else aS='Synchronous';if(listTypeProperties.standardViewProperties!=undefined&&listTypeProperties.standardViewProperties.listEntries!=undefined&&listTypeProperties.standardViewProperties.listEntries>0)ba=listTypeProperties.standardViewProperties.listEntries;else ba=25;K.kreports.standardwpreviewview.store.pageSize=ba;}switch(aS){case 'None':case 'Asynchronous':aB="Displaying Records {0} - {1}";K.kreports.standardwpreviewview.store.getProxy().extraParams.doCount=false;break;case 'Synchronous':aB="Displaying Records {0} - {1} of {2}";K.kreports.standardwpreviewview.store.getProxy().extraParams.doCount=true;break;}if(document.getElementById('reportoptions').value!='')bI=Ext.JSON.decode(document.getElementById('reportoptions').value);else bI=new Object();if(bI.resultsFolded!=undefined&&bI.resultsFolded==true)resultsFolded=true;else resultsFolded=false;K.kreports.standardwpreviewview.grid=new Ext.grid.Panel({id:'kReporterPresentation',store:K.kreports.standardwpreviewview.store,selType:'rowmodel',columns:ColumnsArray,plugins:[{ptype:'rowexpander',rowBodyTpl:['<p>{'+previewId+'}</p><br>']}],viewConfig:{listeners:{itemcontextmenu:function(view,record,item,index,e){if(K.kreports.pdrilldown){K.kreports.pdrilldown.displayContextMenu(record,e);}}}},minHeight:400,monitorResize:true,autoHeight:true,boxMinHeight:250,renderPresentation:function(){this.render('reportGrid');var position=this.getPosition();this.setHeight(Math.max(Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),Math.max(document.body.offsetHeight,document.documentElement.offsetHeight),Math.max(document.body.clientHeight,document.documentElement.clientHeight))-100-position[1]);},reloadPresentation:function(whereConditions){K.kreports.standardwpreviewview.store.removeAll();K.kreports.standardwpreviewview.store.getProxy().extraParams.whereConditions=whereConditions;if(aS!='Synchronous'&&aS!='None'){K.kreports.standardwpreviewview.store.whereConditions=whereConditions;K.kreports.standardwpreviewview.store.reCount=true;}K.kreports.standardwpreviewview.store.load({params:{start:0,limit:ba}});},bS:function(){var bk=new Array();for(var i=0;i<K.kreports.standardwpreviewview.grid.columns.length;i++){bk[i]=new Object({sequence:i+1,dataIndex:K.kreports.standardwpreviewview.grid.columns[i].dataIndex,width:K.kreports.standardwpreviewview.grid.columns[i].getWidth(),isHidden:K.kreports.standardwpreviewview.grid.columns[i].isHidden(),sortState:K.kreports.standardwpreviewview.grid.columns[i].sortState});}return bk;},loadmask:null,tools:[{type:'save',hidden:(accessLevel>0?false:true),handler:function(){K.kreports.standardwpreviewview.grid.loadmask=new Ext.LoadMask(Ext.getCmp('kReporterPresentation'),{msg:"saving layout ..."});K.kreports.standardwpreviewview.grid.loadmask.show();Ext.Ajax.request({url:'index.php?module=KReports&to_pdf=true&action=save_standard_layout',params:{record:document.getElementById('recordid').value,layoutparams:Ext.JSON.encode(K.kreports.standardwpreviewview.grid.bS())},success:function(){K.kreports.standardwpreviewview.grid.loadmask.hide();}});}}],bbar:new Ext.toolbar.Paging({store:K.kreports.standardwpreviewview.store,displayInfo:true,displayMsg:aB}),title:bi('LBL_STANDARDGRIDPANELTITLE'),collapsible:true,collapsed:resultsFolded,listeners:{'viewready':function(){this.setHeight();}}});var kReporterPresentation=K.kreports.standardwpreviewview.grid;if(aS!='Synchronous'&&aS!='None')K.kreports.standardwpreviewview.store.reCount=true;K.kreports.standardwpreviewview.store.load({params:{start:0,limit:ba}});function bm(){Ext.Ajax.request({url:'index.php?module=KReports&action=load_report_count&to_pdf=true',success:function(result){Ext.getCmp('detailViewGrid').setTitle(bi('LBL_STANDARDGRIDPANELTITLE')+' ('+result.responseText+' records found)');store.totalLength=80;},params:{requester:document.getElementById('recordid').value,whereConditions:store.whereConditions}});} 