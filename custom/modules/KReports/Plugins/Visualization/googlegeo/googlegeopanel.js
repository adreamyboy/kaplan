Ext.namespace('K.kreports.googlegeopanel');K.kreports.googlegeopanel.dimension1Combo=new Ext.form.field.ComboBox({typeAhead:true,editable:false,border:1,fieldLabel:bi('LBL_CHARTTYPE_DIMENSION1'),triggerAction:'all',lazyRender:true,queryMode:'local',store:listGridStore,valueField:'fieldid',displayField:'name',listeners:{select:function(thisCombo){}}});K.kreports.googlegeopanel.dimension2Combo=new Ext.form.field.ComboBox({typeAhead:true,editable:false,hidden:true,border:true,fieldLabel:bi('LBL_CHARTTYPE_DIMENSION2'),triggerAction:'all',lazyRender:true,queryMode:'local',store:listGridStore,valueField:'fieldid',displayField:'name',listeners:{select:function(thisCombo){}}});K.kreports.googlegeopanel.ar=new Ext.form.field.ComboBox({typeAhead:true,editable:false,border:1,fieldLabel:bi('LBL_CHARTTYPE_DATASERIES'),triggerAction:'all',lazyRender:true,queryMode:'local',store:listGridStore,valueField:'fieldid',displayField:'name',listeners:{select:function(thisCombo){}}});Ext.define('K.kreports.googlegeopanel.colorModel',{extend:'Ext.data.Model',fields:[{name:'id',type:'string'},{name:'name',type:'string'},{name:'colors',type:'string'}]}),K.kreports.googlegeopanel.ag=new Ext.data.Store({model:K.kreports.googlegeopanel.colorModel,data:kreportavailablecolors});K.kreports.googlegeopanel.ab=new Ext.form.field.ComboBox({store:K.kreports.googlegeopanel.ag,valueField:'id',displayField:'name',typeAhead:false,width:170,labelWidth:70,editable:false,queryMode:'local',triggerAction:'all',selectOnFocus:true,value:'default',listeners:{select:function(thisCombo){K.kreports.googlegeopanel.bn.updateColors();}}});K.kreports.googlegeopanel.bn=new Ext.form.field.Display({updateColors:function(colorId){var colorId=K.kreports.googlegeopanel.ab.getValue();if(colorId!=null){var colorArray=K.kreports.googlegeopanel.ag.findRecord('id',colorId).get('colors').split('*');var colorString='';for(var i=0;i<colorArray.length;i++)colorString=colorString+'<div style="border:1px solid #ddd;float:left;margin-left:5px;width:16px;height:16px;background:'+colorArray[i]+'"></div>';K.kreports.googlegeopanel.bn.setRawValue(colorString);}else K.kreports.googlegeopanel.bn.setRawValue('');}});K.kreports.googlegeopanel.aY=new Ext.panel.Panel({frame:false,bodyPadding:5,border:false,items:[{xtype:'fieldset',collapsible:false,title:bi('LBL_CHARTFS_DATA'),bodyPadding:5,items:[{xtype:'form',border:false,layout:'column',items:[{columnWidth:0.499,border:false,layout:'anchor',defaults:{anchor:'90%'},items:[K.kreports.googlegeopanel.dimension1Combo]},{columnWidth:0.499,border:false,layout:'anchor',defaults:{anchor:'90%'},items:[K.kreports.googlegeopanel.ar,]}]},{xtype:'form',border:false,layout:'column',items:[{columnWidth:0.499,border:false,layout:'anchor',defaults:{anchor:'90%'},items:[]},{columnWidth:0.499,border:false,layout:'anchor',defaults:{anchor:'90%'},items:[{xtype:'fieldcontainer',fieldLabel:bi('LBL_CHARTTYPE_COLORS'),layout:{type:'vbox',align:'stretch'},items:[K.kreports.googlegeopanel.ab,K.kreports.googlegeopanel.bn]}]}]}]},{xtype:'fieldset',defaultType:'textfield',title:bi('LBL_CHARTOPTIONS_FS'),collapsible:false,layout:'anchor',items:[{xtype:'form',border:false,layout:'column',items:[{xtype:'form',border:false,columnWidth:0.499,layout:'anchor',defaults:{anchor:'90%'},items:[{xtype:'textfield',id:'GCGeoOptionsTitle',fieldLabel:bi('LBL_GEOOPTIONS_TITLE')}]},{xtype:'form',border:false,columnWidth:0.499,layout:'anchor',defaults:{anchor:'90%'},items:[{xtype:'textfield',id:'GCGeoOptionsRegion',fieldLabel:bi('LBL_GEOOPTIONS_REGION')},{xtype:'combobox',id:'GCGeoOptionsResolution',fieldLabel:bi('LBL_GEOOPTIONS_RESOLUTION'),value:'countries',typeAhead:true,triggerAction:'all',lazyRender:true,mode:'local',store:new Ext.data.ArrayStore({id:0,fields:['value','text'],data:[['countries',bi('LBL_GEOOPTIONS_COUNTRIES')],['provinces',bi('LBL_GEOOPTIONS_PROVINCES')],['metros',bi('LBL_GEOOPTIONS_METROS')]]}),valueField:'value',displayField:'text'}]},]}]}]});K.kreports.googlegeopanel.panel=new Ext.panel.Panel({layout:'fit',height:400,border:false,aZ:new Object(),al:0,items:[K.kreports.googlegeopanel.aY],setPanelData:function(aZ){this.aZ=aZ;if(this.aZ.dimensions!=undefined){K.kreports.googlegeopanel.dimension1Combo.setValue(this.aZ.dimensions.dimension1);K.kreports.googlegeopanel.ar.setValue(this.aZ.dataseries[0].fieldid)}else{K.kreports.googlegeopanel.dimension1Combo.clearValue();K.kreports.googlegeopanel.ar.clearValue();}if(this.aZ.colors!=undefined)K.kreports.googlegeopanel.ab.setValue(this.aZ.colors);else K.kreports.googlegeopanel.ab.setValue('default');K.kreports.googlegeopanel.bn.updateColors();Ext.getCmp('GCGeoOptionsTitle').setValue(this.aZ.title);Ext.getCmp('GCGeoOptionsRegion').setValue(this.aZ.region);Ext.getCmp('GCGeoOptionsResolution').setValue(this.aZ.resolution);},getPanelData:function(){if(this.aZ.uid==undefined)this.aZ.uid=kGuid();this.aZ.dimensions={dimension1:K.kreports.googlegeopanel.dimension1Combo.getValue()};this.aZ.dataseries=new Array();if(K.kreports.googlegeopanel.ar.getValue()!=null)this.aZ.dataseries.push({fieldid:K.kreports.googlegeopanel.ar.getValue()});this.aZ.colors=K.kreports.googlegeopanel.ab.getValue();this.aZ.title=Ext.getCmp('GCGeoOptionsTitle').getValue();this.aZ.region=Ext.getCmp('GCGeoOptionsRegion').getValue();this.aZ.resolution=Ext.getCmp('GCGeoOptionsResolution').getValue();return this.aZ;}}); 